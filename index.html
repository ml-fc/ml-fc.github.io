<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <meta name="theme-color" content="#0b1220" />
  <meta name="description" content="Manor Lakes Football Club â€“ Weekly match availability and stats tracker" />

  <title>Manor Lakes Football Club</title>

  <link rel="stylesheet" href="./styles.css" />
  <link rel="icon" href="./assets/icons/favicon.ico">
<link rel="icon" type="image/png" sizes="32x32" href="./assets/icons/favicon-32.png">
<link rel="icon" type="image/png" sizes="16x16" href="./assets/icons/favicon-16.png">
<link rel="apple-touch-icon" href="./assets/icons/apple-touch-icon-180.png">

<link rel="manifest" href="./manifest.json" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
<meta name="apple-mobile-web-app-title" content="Manor Lakes FC" />

<link rel="apple-touch-icon" sizes="180x180" href="./assets/icons/apple-touch-icon-180.png">
<link rel="apple-touch-icon" sizes="167x167" href="./assets/icons/apple-touch-icon-167.png">
<link rel="apple-touch-icon" sizes="152x152" href="./assets/icons/apple-touch-icon-152.png">

</head>

<body>
      <!-- Global Loading Bar -->
  <div id="loadingbar" class="loadingbar" aria-hidden="true">
    <div class="loadingbar__fill"></div>
  </div>

  <!-- Top App Bar -->
  <header class="appbar">
    <div class="appbar__left">
      <a class="brand" href="#/match" aria-label="Go to matches">
     <img
  class="brand__mark"
  src="./assets/icons/icon-192.png"
  alt="Manor Lakes FC"
/>

        <div class="brand__text">
          <div class="brand__title">Manor Lakes Football Club</div>
          <div class="brand__subtitle">Availability â€¢ Teams â€¢ Ratings</div>
        </div>
      </a>
    </div>

    <nav class="tabs" aria-label="Primary navigation">
      <a class="tab" href="#/match" data-tab="match">Match</a>
      <a class="tab" href="#/login" data-tab="register">Login</a>
      <a class="tab" href="#/leaderboard" data-tab="leaderboard">Leaderboard</a>
      <a class="tab" href="#/admin" data-tab="admin">Admin</a>
    </nav>
  </header>

  <!-- Main -->
  <main class="shell">
    <div class="container">
      <div id="app"></div>
    </div>
  </main>

  <!-- Footer -->
  <footer class="footer">
    <div class="footer__inner">
      <span>Build: <span id="buildId">â€”</span></span>
    </div>
  </footer>

  <!-- Update available banner -->
  <div id="updateBanner" class="updateBanner" hidden>
    <div class="updateBanner__inner">
      <div class="updateBanner__text">Update available</div>
      <button id="updateReload" class="btn primary" type="button">Reload</button>
    </div>
  </div>

  <!-- Bottom Nav (mobile) -->
  <nav class="bottomnav" aria-label="Bottom navigation">
    <a class="bottomnav__item" href="#/match">
      <span class="bottomnav__icon" aria-hidden="true">âš½</span>
      <span class="bottomnav__label">Match</span>
    </a>
    <a class="bottomnav__item" href="#/login">
      <span class="bottomnav__icon" aria-hidden="true">ğŸ“</span>
      <span class="bottomnav__label">Login</span>
    </a>
    <a class="bottomnav__item" href="#/leaderboard">
      <span class="bottomnav__icon" aria-hidden="true">ğŸ†</span>
      <span class="bottomnav__label">Ranks</span>
    </a>
    <a class="bottomnav__item" href="#/admin">
      <span class="bottomnav__icon" aria-hidden="true">ğŸ› ï¸</span>
      <span class="bottomnav__label">Admin</span>
    </a>
  </nav>
  <!-- Toasts -->
  <div id="toastHost" class="toastHost" aria-live="polite" aria-atomic="true"></div>




  <script type="module">
    // Simple active-tab highlight (works for both top tabs + bottom nav)
    function setActive() {
      const hash = location.hash || "#/match";
      const path = hash.split("?")[0];

      document.querySelectorAll("[data-tab]").forEach(a => {
        a.classList.toggle("tab--active", a.getAttribute("href") === path);
      });

      document.querySelectorAll(".bottomnav__item").forEach(a => {
        a.classList.toggle("bottomnav__item--active", a.getAttribute("href") === path);
      });
    }
    window.addEventListener("hashchange", setActive);
    setActive();
  </script>
  <script type="module">
    import { BUILD_ID } from "./src/config.js";

    // Footer build id
    const bid = document.getElementById("buildId");
    if (bid) bid.textContent = BUILD_ID;

    // Update banner helpers
    const banner = document.getElementById("updateBanner");
    const reloadBtn = document.getElementById("updateReload");
    const showBanner = () => {
      if (banner) banner.hidden = false;
    };
    if (reloadBtn) reloadBtn.addEventListener("click", () => window.location.reload());

    // Service worker registration (cache-busted by BUILD_ID for GitHub Pages)
    if ("serviceWorker" in navigator) {
      window.addEventListener("load", async () => {
        try {
          const reg = await navigator.serviceWorker.register(
            `./service-worker.js?b=${encodeURIComponent(BUILD_ID)}`
          );
              
          // If a new SW takes control, prompt the user to reload.
          let prompted = false;
          navigator.serviceWorker.addEventListener("controllerchange", () => {
            if (prompted) return;
            prompted = true;
            showBanner();
          });

          // If an update is found but control doesn't change immediately (platform quirks),
          // show the banner when an installing worker reaches "installed" and there's an existing controller.
          const maybeTrack = (sw) => {
            if (!sw) return;
            sw.addEventListener("statechange", () => {
              if (sw.state === "installed" && navigator.serviceWorker.controller) {
                showBanner();
              }
            });
          };

          maybeTrack(reg.installing);
          reg.addEventListener("updatefound", () => maybeTrack(reg.installing));
        } catch {
          // ignore
        }
      });
    }
  </script>
  <script type="module" src="./src/app.js"></script>
</body>
</html>
